(function(n){var r={};function i(e){if(r[e]){return r[e].exports}var t=r[e]={i:e,l:false,exports:{}};n[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=n;i.c=r;i.d=function(e,t,n){if(!i.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:n})}};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};i.t=function(t,e){if(e&1)t=i(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);i.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s=0)})([function(e,t){window.addEventListener("load",function(e){var n=document.getElementById("canvas");n.height=999;n.width=999;var t=function(){var o=[];function e(e){o=e}function t(t,e){o[o.findIndex(function(e){return e.Uuid==t})]=e}function n(t){return o.find(function(e){return e.Uuid==t})}function r(e){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);for(var n in o){var r=o[n];var i=parseInt(r.Position/1e4,10);var a=r.Position-i*1e4;i+=Math.round(Math.sin(r.Direction)*r.Speed);a+=Math.round(Math.cos(r.Direction)*r.Speed*-1);if(r.Uuid==d){t.fillStyle="blue"}t.fillRect(i,a,10,10);r.Position=i*1e4+a;o[n]=r;t.fillStyle="black"}}return{setObject:t,getObject:n,setObjects:e,drawCanvas:r}};var l=t();var r;var i=document.getElementById("output");var a=document.getElementById("type");var o=document.getElementById("input");var f;var d;var u;var c=(new Date).getTime();var s=0;var v=function(e){var t=document.createElement("div");t.innerHTML=e;i.appendChild(t)};document.getElementById("open").onclick=function(e){var t=document.getElementById("address").value;if(f){return false}f=new WebSocket("ws://"+t+"/ws");r=setInterval(function(){l.drawCanvas(n)},100);f.onopen=function(e){v("OPEN")};f.onclose=function(e){v("CLOSE");f=null;clearInterval(u);u=null};f.onmessage=function(e){if(!e.data){return}var t=JSON.parse(e.data);var n=t.Time;switch(t.Action){case"pong":s=c-n;break;case"status":l.setObjects(Object.values(t.Data.Objects.start));break;case"move":var r=l.getObject(t.Uuid);r.Speed=t.Data.Speed;r.Direction=t.Data.Direction;l.setObject(t.Uuid,r);break;case"login":d=t.Data.Uuid;break}v("RESPONSE: "+e.data)};f.onerror=function(e){v("ERROR: "+e.data)};u=setInterval(m,5e3);return false};document.getElementById("send").onclick=function(e){if(!f){return false}v("SEND: "+o.value);var t={actionType:a.value,value:o.value,time:(new Date).getTime()-s};f.send(JSON.stringify(t));return false};document.getElementById("close").onclick=function(e){if(!f){return false}f.close();clearInterval(r);return false};function m(){if(!f){return}c=(new Date).getTime();var e={actionType:"ping",time:c-s};f.send(JSON.stringify(e))}document.getElementById("left").onclick=function(e){if(!f){return false}v("SEND: left");var t={actionType:"move",value:{Direction:4.7,Speed:1},time:(new Date).getTime()-s};f.send(JSON.stringify(t));return false};document.getElementById("right").onclick=function(e){if(!f){return false}v("SEND: right");var t={actionType:"move",value:{Direction:1.5,Speed:1},time:(new Date).getTime()-s};f.send(JSON.stringify(t));return false};document.getElementById("up").onclick=function(e){if(!f){return false}v("SEND: up");var t={actionType:"move",value:{Direction:0,Speed:1},time:(new Date).getTime()-s};f.send(JSON.stringify(t));return false};document.getElementById("down").onclick=function(e){if(!f){return false}v("SEND: down");var t={actionType:"move",value:{Direction:3.14,Speed:1},time:(new Date).getTime()-s};f.send(JSON.stringify(t));return false};var p;document.getElementById("canvas").onclick=function(e){if(!f){return false}clearTimeout(p);var t=l.getObject(d);var n=parseInt(t.Position/1e4,10);var r=t.Position-n*1e4;var i=e.x;var a=e.y;var o=Math.sqrt(Math.pow(i-n,2)+Math.pow(a-r,2));var u=(i>=n?1:-1)*Math.acos(-1*(a-r)/o);t.Direction=Math.round(u*100)/100;l.setObject(d,t);v("SEND: move with mouse");var c={actionType:"move",value:{Direction:Math.round(u*100)/100,Speed:3},time:(new Date).getTime()-s};f.send(JSON.stringify(c));p=setTimeout(function(){var e={actionType:"move",value:{Direction:Math.round(u*100)/100,Speed:0},time:(new Date).getTime()-s};f.send(JSON.stringify(e))},o/3*100);return false}})}]);